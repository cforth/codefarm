
//根据json数据建立股票数据二维数组
function stockArrayMake(data) {
  var hqArr = new Array(
    ["1000826", "十大金股", "2013-11-06", "34.89", "40.00"],
    ["1300055", "十大金股", "2013-10-25", "37.00", "49.00"], 
    ["1300157", "十大金股", "2013-11-06", "24.83", "32.00"],
    ["0600518", "十大金股", "2013-10-29", "19.48", "22.50"],
    ["1300289", "十大金股", "2013-11-06", "30.48", "36.54"],
    ["1000063", "十大金股", "2013-11-06", "15.91", "17.28"],
    ["1300315", "十大金股", "2013-10-25", "28.60", "35.00"],
    ["1002396", "十大金股", "2013-10-25", "17.25", "21.00"],
    ["0601766", "十大金股", "2013-11-06", "5.00",  "6.50" ],
    ["1300128", "十大金股", "2013-10-23", "10.90", "12.00"],
    ["0601699", "煤炭",     "2013-11-01", "11.52", "12.90"],
    ["1002422", "医药",     "2013-10-31", "46.10", "53.00"],
    ["0600633", "传媒娱乐", "2013-10-31", "34.66", "45.00"],
    ["1000002", "房地产",   "2013-10-31", "9.08",  "10.60"],
    ["0601601", "保险类",   "2013-10-31", "17.13", "22.00"],
    ["0600157", "煤炭",     "2013-10-31", "6.01",  "7.80" ],
    ["0601238", "汽车类",   "2013-10-31", "7.92",  "9.50" ],
    ["0600597", "食品饮料", "2013-10-30", "21.64", "27.00"],
    ["0600637", "传媒娱乐", "2013-10-30", "38.78", "45.00"],
    ["0600699", "汽车类",   "2013-10-30", "13.62", "17.00"],
    ["0600886", "电力",     "2013-10-30", "4.02",  "5.12" ],
    ["0600837", "证券类",   "2013-10-30", "11.75", "14.62"],
    ["1002185", "半导体",   "2013-10-29", "10.94", "14.20"],
    ["1002572", "家居用品", "2013-10-29", "20.78", "23.90"],
    ["1002631", "家居用品", "2013-10-29", "12.09", "14.50"],
    ["1002565", "造纸",     "2013-10-29", "16.54", "19.85"],
    ["1002604", "食品饮料", "2013-10-29", "20.17", "25.60"],
    ["0600305", "食品饮料", "2013-10-28", "33.26", "41.60"],
    ["1002612", "纺织服装", "2013-10-28", "23.93", "27.90"],
    ["1002303", "造纸",     "2013-10-28", "20.21", "24.25"],
    ["1002305", "房地产",   "2013-10-28", "7.94",  "10.32"],
    ["1002048", "汽车类",   "2013-10-28", "8.24",  "10.20"],
    ["0600805", "综合类",   "2013-10-28", "10.30", "13.30"],
    ["0600403", "煤炭",     "2013-10-28", "9.34",  "11.90"],
    ["0600674", "电力",     "2013-10-28", "11.47", "14.14"],
    ["1002683", "化工",     "2013-10-28", "28.12", "35.00"],
    ["1000669", "供气供热", "2013-10-25", "31.95", "40.33"],
    ["1002284", "汽车类",   "2013-10-25", "8.74",  "10.80"],
    ["1002410", "软件服务", "2013-10-25", "29.83", "38.18"],
    ["1002022", "医药",     "2013-10-25", "15.26", "18.30"],
    ["1002448", "运输设备", "2013-10-25", "13.27", "16.50"],
    ["0600741", "汽车类",   "2013-10-25", "10.62", "13.65"],
    ["1002286", "食品饮料", "2013-10-25", "16.86", "18.90"],
    ["1000726", "纺织服饰", "2013-10-25", "8.95",  "11.60"],
    ["1002376", "电脑设备", "2013-10-25", "10.76", "13.25"],
    ["0600050", "电信运营", "2013-10-25", "3.44",  "4.00" ],
    ["1002462", "商业连锁", "2013-10-24", "14.99", "18.90"],
    ["0601222", "电气仪表", "2013-10-24", "25.52", "29.70"],
    ["0600761", "工程机械", "2013-10-24", "10.22", "12.00"],
    ["1300257", "通用机械", "2013-10-23", "35.85", "45.00"],
    ["1002230", "软件服务", "2013-10-22", "48.86", "58.63"],
    ["0601799", "汽车类",   "2013-10-22", "12.78", "14.00"],
    ["1300074", "通信设备", "2013-10-22", "32.70", "38.85"],
    ["1300258", "汽车类",   "2013-10-21", "11.88", "14.50"],
    ["1002138", "元器件",   "2013-10-21", "16.56", "19.80"],
    ["1300005", "纺织服装", "2013-10-21", "16.25", "18.70"],
    ["1002251", "商业连锁", "2013-10-18", "14.78", "16.50"],
    ["1300144", "旅游",     "2013-10-18", "19.65", "21.32"],
    ["1002126", "汽车类",   "2013-10-18", "7.87",  "9.45" ],
    ["0600828", "商业连锁", "2013-10-16", "5.99",  "6.75" ],
    ["0600138", "旅游",     "2013-10-16", "18.40", "21.00"],
    ["1300299", "软件服务", "2013-10-15", "18.42", "20.00"],
    ["1300287", "软件服务", "2013-10-15", "33.50", "40.20"],
    ["1300253", "软件服务", "2013-10-14", "57.75", "70.00"],
    ["1002521", "造纸",     "2013-10-14", "8.61",  "9.80" ],
    ["1002063", "软件服务", "2013-10-14", "19.50", "26.50"],
    ["1300094", "农林牧渔", "2013-10-14", "7.37",  "8.40" ],
    ["1002313", "通信设备", "2013-10-14", "19.96", "20.00"]
  )

  var length = hqArr.length;
  var id;
  var stockArr = new Array();
  for(var i=0;i<length;i++) {
    id = hqArr[i][0];
    stockArr[i] = new Array();
    stockArr[i][0] = i + 1;
    stockArr[i][1] = data[id]["symbol"]; 
    stockArr[i][2] = data[id]["name"]; 
    stockArr[i][3] = (data[id]["percent"] * 100).toFixed(2) + "%"; 
    stockArr[i][4] = data[id]["price"]; 
    stockArr[i][5] = hqArr[i][1]; 
    stockArr[i][6] = hqArr[i][2]; 
    stockArr[i][7] = hqArr[i][4]; 
  }
  
  tableMake(stockArr, "gdzq");  

}

function doJsonp(url, callback) {
        // 创建script标签，设置其属性
        var script = document.createElement('script');
        script.setAttribute('src', url);
        // 把script标签加入head，此时调用开始
        document.getElementsByTagName('head')[0].appendChild(script); 
       
         
//        script.onload = script.onreadystatechange = function(){ 
 //         if (!this.readyState || 
  //        this.readyState === "loaded" || 
  //        this.readyState === "complete" ) {
   //       this.onload = this.onreadystatechange = null;
   //       this.parentNode.removeChild(this);
    //      }
    //    }

    }


//建立空表格，并给每个单元格设置id，如第3行第2列，则此单元格id为name+“L3R2”
function emptyTableMake(name) {
  document.write("<table class=\"sortable\" id=\"stocktable\">\
      <tr id=\"sthead\">\
        <td>序号<\/td>\
        <td>股票代码<\/td>\
        <td>股票名称<\/td>\
        <td>当日涨跌<\/td>\
        <td>当前价格<\/td>\
        <td>行业分类<\/td>\
        <td>关注日期<\/td>\
        <td>目标价格<\/td>\
      <\/tr>");

  tableLength = 68;
  tableWidth = 8;  

  for(var i=0;i<tableLength;i++) {
    document.write("<tr>");
    for(var j=0;j<tableWidth;j++) {
      document.write("<td id=\"" + name + "L" + i +"R" + j +"\">"+ " " + "</td>");
    }
    document.write("</tr>");
  }

  document.write("</table>");
}


function tableMake(arr, name) {
  var length = arr.length;
  var width = arr[0].length;
  var id;
  for(var i=0;i<length;i++) {
    for(var j=0;j<width;j++) {
      id = name + "L" + i + "R" + j;
      document.getElementById(id).innerHTML=arr[i][j];
    }
  }
}
